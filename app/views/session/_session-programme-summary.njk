{% for programme in session.programmes %}
  {% set columnWidth = "quarter" if session.offersAlternativeVaccine or programme.type == ProgrammeType.MMR else "third" %}

  {{ appHeading({
    title: programme.name,
    summary: __mf("session.eligible.count", {
      count: session.patients.length
    }),
    level: 3,
    size: "m"
  }) }}

  <div class="nhsuk-grid-row nhsuk-card-group">
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: ProgrammeOutcome.Consent,
        headingLevel: 3,
        colour: "blue",
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.Consent),
        href: session.uri + "/report?report=" + ProgrammeOutcome.Consent + "&programme_id=" + programme.id
      }) }}
    </div>
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: ProgrammeOutcome.Triage,
        headingLevel: 3,
        colour: "blue",
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.Triage),
        href: session.uri + "/report?report=" + ProgrammeOutcome.Triage + "&programme_id=" + programme.id
      }) }}
    </div>
  {% if programme.standardVaccine.criteria == VaccineCriteria.Intranasal %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: __("session.tally.dueForVaccineCriteria.label", {
          vaccineCriteria: programme.standardVaccine.criteria | lower
        }),
        colour: "green",
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.Due, programme.standardVaccine.criteria),
        href: session.uri + "/report?report=" + ProgrammeOutcome.Due + "&programme_id=" + programme.id + "&vaccineCriteria=" + programme.standardVaccine.criteria
      }) }}
    </div>
  {% else %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: ProgrammeOutcome.Due,
        headingLevel: 3,
        colour: "green",
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.Due),
        href: session.uri + "/report?report=" + ProgrammeOutcome.Due + "&programme_id=" + programme.id
      }) }}
    </div>
  {% endif %}
  {% if programme.alternativeVaccine %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: __("session.tally.dueForVaccineCriteria.label", {
          vaccineCriteria: programme.alternativeVaccine.criteria | lower
        }),
        colour: "green",
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.Due, programme.alternativeVaccine.criteria),
        href: session.uri + "/report?report=" + ProgrammeOutcome.Due + "&programme_id=" + programme.id + "&vaccineCriteria=" + programme.alternativeVaccine.criteria
      }) }}
    </div>
  {% endif %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: ProgrammeOutcome.Refused,
        headingLevel: 3,
        colour: "dark-orange",
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.Refused),
        href: session.uri + "/report?report=" + ProgrammeOutcome.Refused + "&programme_id=" + programme.id
      }) }}
    </div>
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: ProgrammeOutcome.Deferred,
        headingLevel: 3,
        colour: "red",
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.Deferred),
        href: session.uri + "/report?report=" + ProgrammeOutcome.Deferred + "&programme_id=" + programme.id
      }) }}
    </div>
  {% if programme.type == ProgrammeType.MMR or programme.type == ProgrammeType.Flu %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: ProgrammeOutcome.PartiallyVaccinated,
        headingLevel: 3,
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.PartiallyVaccinated),
        href: session.uri + "/report?report=" + ProgrammeOutcome.PartiallyVaccinated + "&programme_id=" + programme.id
      }) }}
    </div>
  {% endif %}
    <div class="nhsuk-grid-column-one-{{ columnWidth }} nhsuk-card-group__item">
      {{ appDataCard({
        heading: ProgrammeOutcome.Vaccinated,
        headingLevel: 3,
        compact: true,
        data: session.tally(programme.id, ProgrammeOutcome.Vaccinated),
        href: session.uri + "/report?report=" + ProgrammeOutcome.Vaccinated + "&programme_id=" + programme.id
      }) }}
    </div>
  </div>
{% endfor %}
